<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mis Favoritos</title>
  <style>
    body { font-family: 'Segoe UI', sans-serif; background: #eef1f5; padding: 20px; }
    h1 { text-align: center; }
    table { width: 100%; border-collapse: collapse; background: #fff; margin-top: 20px; }
    th, td { padding: 10px; border: 1px solid #ccc; text-align: center; }
    button { background: #e74c3c; color: #fff; border: none; border-radius: 5px; padding: 6px 12px; cursor: pointer; }
    button:hover { background: #c0392b; }
  </style>
</head>
<body>
  <nav style="background:#222;padding:10px 0 10px 0;text-align:center;margin-bottom:20px;">
    <a href="catalogo.html" style="color:#fff;margin:0 15px;text-decoration:none;font-weight:bold;">Catálogo</a>
    <a href="busqueda.html" style="color:#fff;margin:0 15px;text-decoration:none;font-weight:bold;">Búsqueda</a>
    <a href="favoritos.html" style="color:#fff;margin:0 15px;text-decoration:none;font-weight:bold;">Favoritos</a>
  </nav>
  <h1>Mis Productos Favoritos</h1>
  <table>
    <thead>
      <tr><th>Nombre</th><th>Categoría</th><th>Precio</th><th>Stock</th><th>Descripción</th><th>Quitar</th></tr>
    </thead>
    <tbody id="tabla-favoritos"></tbody>
  </table>
  <script>
    // Favoritos en localStorage por simplicidad
    const API = 'http://localhost:4550';
    function getFavoritos() {
      return JSON.parse(localStorage.getItem('favoritos') || '[]');
    }
    async function cargarFavoritos() {
      const favoritos = getFavoritos();
      if (!favoritos.length) {
        document.getElementById('tabla-favoritos').innerHTML = '<tr><td colspan="6">No tienes productos favoritos.</td></tr>';
        return;
      }
      const res = await fetch(API + '/productos');
      const productos = await res.json();
      const tabla = document.getElementById('tabla-favoritos');
      tabla.innerHTML = '';
      productos.filter(p => favoritos.includes(p._id)).forEach(p => {
        tabla.innerHTML += `<tr><td>${p.nombre}</td><td>${p.categoria||''}</td><td>${p.precio}</td><td>${p.stock}</td><td>${p.descripcion||''}</td><td><button onclick="quitarFavorito('${p._id}')">Quitar</button></td></tr>`;
      });
    }
    function quitarFavorito(id) {
      let favoritos = getFavoritos();
      favoritos = favoritos.filter(f => f !== id);
      localStorage.setItem('favoritos', JSON.stringify(favoritos));
      cargarFavoritos();
    }
    window.addEventListener('storage', cargarFavoritos);
    cargarFavoritos();
  </script>
</body>
</html>
